<!DOCTYPE html>
<html lang="en" dir="ltr"><head><title>反向传播BP算法</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;family=IBM Plex Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="Quartz 4"/><meta property="og:title" content="反向传播BP算法"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="反向传播BP算法"/><meta name="twitter:description" content="入门系列文章： 深度学习入门系列一-梯度下降法 深度学习入门系列一-梯度下降法-② 梯度下降法3 深度学习入门系列4-反向传播BP算法 深度学习入门系列-逻辑回归 深度学习入门系列6-Convolution-Neural-Network-CNN-卷积神经网络 深度学习入门系列7-Tips-For-DeepLearning-全程高能 深度学习入门系列8-Tips-For-DeepLearning-2-全程高能 之前讲过机器学习的三个步骤，深度学习Deep Learning非常的类似，可以概括为以下几步： (设置函数) → 搭建神经网络 (函数的好坏定义) → 设置损失函数 (找出最优函数) → ..."/><meta property="og:description" content="入门系列文章： 深度学习入门系列一-梯度下降法 深度学习入门系列一-梯度下降法-② 梯度下降法3 深度学习入门系列4-反向传播BP算法 深度学习入门系列-逻辑回归 深度学习入门系列6-Convolution-Neural-Network-CNN-卷积神经网络 深度学习入门系列7-Tips-For-DeepLearning-全程高能 深度学习入门系列8-Tips-For-DeepLearning-2-全程高能 之前讲过机器学习的三个步骤，深度学习Deep Learning非常的类似，可以概括为以下几步： (设置函数) → 搭建神经网络 (函数的好坏定义) → 设置损失函数 (找出最优函数) → ..."/><meta property="og:image:alt" content="入门系列文章： 深度学习入门系列一-梯度下降法 深度学习入门系列一-梯度下降法-② 梯度下降法3 深度学习入门系列4-反向传播BP算法 深度学习入门系列-逻辑回归 深度学习入门系列6-Convolution-Neural-Network-CNN-卷积神经网络 深度学习入门系列7-Tips-For-DeepLearning-全程高能 深度学习入门系列8-Tips-For-DeepLearning-2-全程高能 之前讲过机器学习的三个步骤，深度学习Deep Learning非常的类似，可以概括为以下几步： (设置函数) → 搭建神经网络 (函数的好坏定义) → 设置损失函数 (找出最优函数) → ..."/><meta property="og:image" content="https://runyangnotes.top/static/og-image.png"/><meta property="og:image:url" content="https://runyangnotes.top/static/og-image.png"/><meta name="twitter:image" content="https://runyangnotes.top/static/og-image.png"/><meta property="og:image:type" content="image/.png"/><meta property="twitter:domain" content="runyangnotes.top"/><meta property="og:url" content="https://runyangnotes.top/C_Research_Knowledge/深度学习入门系列4-反向传播BP算法"/><meta property="twitter:url" content="https://runyangnotes.top/C_Research_Knowledge/深度学习入门系列4-反向传播BP算法"/><link rel="icon" href="../static/icon.png"/><meta name="description" content="入门系列文章： 深度学习入门系列一-梯度下降法 深度学习入门系列一-梯度下降法-② 梯度下降法3 深度学习入门系列4-反向传播BP算法 深度学习入门系列-逻辑回归 深度学习入门系列6-Convolution-Neural-Network-CNN-卷积神经网络 深度学习入门系列7-Tips-For-DeepLearning-全程高能 深度学习入门系列8-Tips-For-DeepLearning-2-全程高能 之前讲过机器学习的三个步骤，深度学习Deep Learning非常的类似，可以概括为以下几步： (设置函数) → 搭建神经网络 (函数的好坏定义) → 设置损失函数 (找出最优函数) → ..."/><meta name="generator" content="Quartz"/><link href="../index.css" rel="stylesheet" type="text/css" data-persist="true"/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2hvbWUvcnVubmVyL3dvcmsvcnVueWFuZy1ub3Rlcy9ydW55YW5nLW5vdGVzL3F1YXJ0ei9jb21wb25lbnRzL3N0eWxlcyIsInNvdXJjZXMiOlsibWVybWFpZC5pbmxpbmUuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTs7O0FBS0Y7RUFDRTtFQUNBOzs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTs7QUFHRjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBSUo7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFOztBQUdGO0VBQ0U7O0FBSUY7RUFDRTtFQUNBO0VBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIuZXhwYW5kLWJ1dHRvbiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxvYXQ6IHJpZ2h0O1xuICBwYWRkaW5nOiAwLjRyZW07XG4gIG1hcmdpbjogMC4zcmVtO1xuICByaWdodDogMDsgLy8gTk9URTogcmlnaHQgd2lsbCBiZSBzZXQgaW4gbWVybWFpZC5pbmxpbmUudHNcbiAgY29sb3I6IHZhcigtLWdyYXkpO1xuICBib3JkZXItY29sb3I6IHZhcigtLWRhcmspO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gIGJvcmRlcjogMXB4IHNvbGlkO1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIG9wYWNpdHk6IDA7XG4gIHRyYW5zaXRpb246IDAuMnM7XG5cbiAgJiA+IHN2ZyB7XG4gICAgZmlsbDogdmFyKC0tbGlnaHQpO1xuICAgIGZpbHRlcjogY29udHJhc3QoMC4zKTtcbiAgfVxuXG4gICY6aG92ZXIge1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICBib3JkZXItY29sb3I6IHZhcigtLXNlY29uZGFyeSk7XG4gIH1cblxuICAmOmZvY3VzIHtcbiAgICBvdXRsaW5lOiAwO1xuICB9XG59XG5cbnByZSB7XG4gICY6aG92ZXIgPiAuZXhwYW5kLWJ1dHRvbiB7XG4gICAgb3BhY2l0eTogMTtcbiAgICB0cmFuc2l0aW9uOiAwLjJzO1xuICB9XG59XG5cbiNtZXJtYWlkLWNvbnRhaW5lciB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgY29udGFpbjogbGF5b3V0O1xuICB6LWluZGV4OiA5OTk7XG4gIGxlZnQ6IDA7XG4gIHRvcDogMDtcbiAgd2lkdGg6IDEwMHZ3O1xuICBoZWlnaHQ6IDEwMHZoO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBkaXNwbGF5OiBub25lO1xuICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNHB4KTtcbiAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjUpO1xuXG4gICYuYWN0aXZlIHtcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIH1cblxuICAmID4gI21lcm1haWQtc3BhY2Uge1xuICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tbGlnaHQpO1xuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgdG9wOiA1MCU7XG4gICAgbGVmdDogNTAlO1xuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xuICAgIGhlaWdodDogODB2aDtcbiAgICB3aWR0aDogODB2dztcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRlbnQge1xuICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogMCAwO1xuICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMXMgZWFzZTtcbiAgICAgIG92ZXJmbG93OiB2aXNpYmxlO1xuICAgICAgbWluLWhlaWdodDogMjAwcHg7XG4gICAgICBtaW4td2lkdGg6IDIwMHB4O1xuXG4gICAgICBwcmUge1xuICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgIH1cblxuICAgICAgc3ZnIHtcbiAgICAgICAgbWF4LXdpZHRoOiBub25lO1xuICAgICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICB9XG4gICAgfVxuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRyb2xzIHtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIGJvdHRvbTogMjBweDtcbiAgICAgIHJpZ2h0OiAyMHB4O1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGdhcDogOHB4O1xuICAgICAgcGFkZGluZzogOHB4O1xuICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHQpO1xuICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gICAgICB6LWluZGV4OiAyO1xuXG4gICAgICAubWVybWFpZC1jb250cm9sLWJ1dHRvbiB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICB3aWR0aDogMzJweDtcbiAgICAgICAgaGVpZ2h0OiAzMnB4O1xuICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodCk7XG4gICAgICAgIGNvbG9yOiB2YXIoLS1kYXJrKTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICAgICAgZm9udC1mYW1pbHk6IHZhcigtLWJvZHlGb250KTtcbiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblxuICAgICAgICAmOmhvdmVyIHtcbiAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgJjphY3RpdmUge1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxcHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3R5bGUgdGhlIHJlc2V0IGJ1dHRvbiBkaWZmZXJlbnRseVxuICAgICAgICAmOm50aC1jaGlsZCgyKSB7XG4gICAgICAgICAgd2lkdGg6IGF1dG87XG4gICAgICAgICAgcGFkZGluZzogMCAxMnB4O1xuICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19 */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" data-persist="true"/><script src="../prescript.js" type="application/javascript" data-persist="true"></script><script type="application/javascript" data-persist="true">const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://runyangnotes.top/index.xml"/></head><body data-slug="C_Research_Knowledge/深度学习入门系列4-反向传播BP算法"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="..">Quartz 4</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg><p>Search</p></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="Reader mode"><title>Reader mode</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slugSegment!==\&quot;tags\&quot;&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-114"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-114" class="explorer-content" aria-expanded="false" role="group"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../C_Research_Knowledge/">C_Research_Knowledge</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>反向传播BP算法</a></div></nav><h1 class="article-title">反向传播BP算法</h1><p show-comma="true" class="content-meta"><time datetime="2020-02-12T21:24:39.000Z">Feb 12, 2020</time><span>12 min read</span></p><ul class="tags"><li><a href="../tags/Optimization" class="internal tag-link">Optimization</a></li></ul></div></div><article class="popover-hint"><p><em>入门系列文章：</em>
<a href="../C_Research_Knowledge/深度学习入门系列一-梯度下降法" class="internal alias" data-slug="C_Research_Knowledge/深度学习入门系列一-梯度下降法">深度学习入门系列一-梯度下降法</a>
<a href="../C_Research_Knowledge/深度学习入门系列一-梯度下降法-②" class="internal alias" data-slug="C_Research_Knowledge/深度学习入门系列一-梯度下降法-②">深度学习入门系列一-梯度下降法-②</a>
<a href="../C_Research_Knowledge/梯度下降法3" class="internal alias" data-slug="C_Research_Knowledge/梯度下降法3">梯度下降法3</a>
<a href="../C_Research_Knowledge/深度学习入门系列4-反向传播BP算法" class="internal alias" data-slug="C_Research_Knowledge/深度学习入门系列4-反向传播BP算法">深度学习入门系列4-反向传播BP算法</a>
<a href="../C_Research_Knowledge/深度学习入门系列-逻辑回归" class="internal alias" data-slug="C_Research_Knowledge/深度学习入门系列-逻辑回归">深度学习入门系列-逻辑回归</a>
<a href="../C_Research_Knowledge/深度学习入门系列6-Convolution-Neural-Network-CNN-卷积神经网络" class="internal alias" data-slug="C_Research_Knowledge/深度学习入门系列6-Convolution-Neural-Network-CNN-卷积神经网络">深度学习入门系列6-Convolution-Neural-Network-CNN-卷积神经网络</a>
<a href="../C_Research_Knowledge/深度学习入门系列7-Tips-For-DeepLearning-全程高能" class="internal alias" data-slug="C_Research_Knowledge/深度学习入门系列7-Tips-For-DeepLearning-全程高能">深度学习入门系列7-Tips-For-DeepLearning-全程高能</a>
<a href="../C_Research_Knowledge/深度学习入门系列8-Tips-For-DeepLearning-2-全程高能" class="internal alias" data-slug="C_Research_Knowledge/深度学习入门系列8-Tips-For-DeepLearning-2-全程高能">深度学习入门系列8-Tips-For-DeepLearning-2-全程高能</a></p>
<p>之前讲过机器学习的三个步骤，<strong>深度学习</strong><code>Deep Learning</code>非常的类似，可以概括为以下几步：</p>
<ul>
<li>(设置函数) <span>→</span> 搭建<strong>神经网络</strong></li>
<li>(函数的好坏定义) <span>→</span> 设置<strong>损失函数</strong></li>
<li>(找出最优函数) <span>→</span> <strong>反向传播</strong>更新参数</li>
</ul>
<p>第一步之前的设置函数，在这里用神经网络来替代了；</p>
<p>在线性回归逻辑回归中可以直接计算梯度，但是深度学习神经网络比较深，不能一下子求出梯度，因此本文主要来探讨一下反向传播 <code>Back Propagation</code>算法。</p>
<p><strong>同时，本文会附上手动搭建神经网络、计算梯度、实现反向传播的代码，纯手写只用到了numpy库！</strong></p>
<h2 id="前置知识">前置知识<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#前置知识" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>神经网络的反向传播并不需要很高深的数学知识，需要掌握<strong>链式求导法则 (Chain Rule)</strong>。下面会一步步从数学上求出微分 ，并且理解这种算法的精妙之处。</p>
<h2 id="案例背景">案例背景<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#案例背景" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><img src="https://user-images.githubusercontent.com/60562661/74358378-50263500-4dfc-11ea-8f03-2fac002d131d.png" alt/></p>
<p>一个有代表性的例子，输入层经过神经网络得到输出值，与真实值之间存在误差，这里用交叉熵作为损失函数，因此在这里，要求梯度也就是求损失函数对于w的偏微分。</p>
<h2 id="层层深入">层层深入<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#层层深入" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><img src="../Resources-Images/Pasted-image-20240322225033.png" width="auto" height="auto" alt/></p>
<p>把上面具体的神经网络展开，假设只有两个神经元，这里只对w求微分，b的方式是一样的，所以以w为例。</p>
<p>首先，根据上图的函数以及chain rules，损失函数C对w的偏微分可以拆解为两部分</p>
<ul>
<li>C 对于 z 的偏导数</li>
<li>z 对于 w 的偏导数</li>
</ul>
<h3 id="forward-pass">Forward Pass<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#forward-pass" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>（先讲第二部分）其中，z 对于 w 的偏导数比较容易，可以很容易的看出来 z 对于 w1 的偏导数就是w之前的输入值，也就是 x1，同理 z 对于 w2 的偏导数就是 x2，下面的图强化一下 z 对于 w 的偏导数</p>
<img src="https://user-images.githubusercontent.com/60562661/74358383-51eff880-4dfc-11ea-9f7b-87aea43f3483.png" style="zoom:50%;"/>
<p>可以观察到z对于每个w的偏导数就是 当前权重所之前的输入值，这样比较拗口，英语会比较好理解：</p>
<p><strong>The value of the input connected by the weight</strong> .通俗的说就是这条线从哪里出来，出来的那个节点值就是z对于这条线也就是这个w的偏微分。</p>
<p>这里也可以看出，前向传播可以算出每个中间值，也就是计算出了每个梯度的上述第二部分。</p>
<h3 id="backward-pass">Backward Pass<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#backward-pass" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>下面看第一部分比较复杂的，也就是 C 对于 z 的偏导数。</p>
<p><img src="https://user-images.githubusercontent.com/60562661/74358367-4dc3db00-4dfc-11ea-81b3-7bf35d6c3b66.png" alt="1581523046931"/></p>
<p>上图中 z 经过 sigmoid 函数 得到 a，a 继续传播到下一层，此时 C 对于 z 的偏导数可以转化为上图中的下面公式所写的。在求和的两部分中，同样的各自又都分为两部分，与上述的两部分类似。z’ 对于 a 的偏导数很容易，就直接是 w3 ，相应的 z’‘ 就是 w4.</p>
<p>所以此时问题就转化为 C对于z’ C对于z‘’ 的偏微分，如果这两部分知道那么就可以求出来 C对a的偏微分，同样的C对z的偏微分也就求出来了，也就解决了这部分问题。以下内容是<strong>关键：</strong></p>
<h3 id="反求">反求<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#反求" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<img src="https://user-images.githubusercontent.com/60562661/74358708-e195a700-4dfc-11ea-978f-34ace433b4ce.png" alt="1581523822435" style="zoom:50%;"/>
<p>上图的下面的公式只是把值带入了前一步中的公式，但是可以想象一下，这里面的 乘法、加法 操作 很像是神经网络的前向传播，所以这里就可以想象成一个新的神经网络，只不过是反过来计算的，这时候就会计算出来 C 对于 z 的偏微分。值得注意的是 上图中 <code>sigmoid’(z)</code> 是个常数，因为z前向传播时已经计算出来了，所以这里就是计算一个数而已。因此现在到这一步，<strong>说明知道后面两项的偏微分可以求出前面的。</strong> 此时问题依然是 C对于z’ C对于z‘’ 的偏微分。</p>
<h3 id="大胆假设细心求证">大胆假设、细心求证<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#大胆假设细心求证" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="假设一-easy">假设一 (easy)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#假设一-easy" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>假设 <strong>z‘ z’‘</strong> 之后经过激活函数直接是最终的输出，此时求微分就很简单了，如下图：</p>
<p><img src="https://user-images.githubusercontent.com/60562661/74358371-4ef50800-4dfc-11ea-851d-3f8bb542090d.png" alt="1581524647050"/></p>
<p>其中，C 对于 y1 的偏微分就是损失函数的偏微分，y1 对于 z’ 的偏微分就是根据<strong>激活函数</strong>（上图最后的橙色圆圈）求出微分很容易，z‘’ 同理。</p>
<p>在此种假设下，此时已经得出了 C 对于 z‘、 C 对于 z’‘ 的偏微分，回溯到前一个步骤，就求出了 C对于z的偏导，在往前回到最初步，发现此时已经求出了两个 需要的条件，此时就可以算出 C 对于 w1 ，C  对于 w2 的偏微分。</p>
<p><strong>也就是说，忙活到现在，也就只是算出来了第一个神经元的两条线(2个w)的梯度！</strong></p>
<h4 id="假设二-normal">假设二 (Normal)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#假设二-normal" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>假设 <strong>z‘ z’‘</strong> 之后 依然有很多层，如下图：</p>
<p>)</p>
<p>由<code>反求</code>部分我们已经知道想要求 C对于 z’（or z‘’） 的偏导数，需要知道后面 C 对于 Za 及 Zb 的偏导数，所以需求会一直往后寻找，递归这个过程，知道到达输出层，然后一层层往前就会求出来最初始的梯度，如下图：</p>
<p><img src="https://user-images.githubusercontent.com/60562661/74358380-51576200-4dfc-11ea-9ec1-958f51f62321.png" alt/></p>
<p>至此，如果理解了这些，就已经理解了反向传播的原理了。</p>
<h2 id="conclusion--question">Conclusion &amp; Question<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#conclusion--question" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="bp算法总结">BP算法总结<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#bp算法总结" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><code>Back Propagation</code>  算法分为两部分</p>
<ul>
<li>前向传播 求出 z 对于 w 的偏导数</li>
<li>反向传播 求出 C 对于 z 的偏导数</li>
<li>两个值相乘就是梯度</li>
</ul>
<h3 id="思考">思考<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#思考" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>从前到后的传播直接计算每个参数的梯度为什么比BP算法差?</p>
<h4 id="前向传播计算梯度">前向传播计算梯度<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#前向传播计算梯度" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>从前到后直接传播计算梯度，第一层的w需要知道后面所有的层的梯度，此时会进行一趟计算；2-end；</p>
<p>继续求第二层w 的梯度，需要知道后面所有层的梯度，也就是 3 - end； 最后加起来就是：</p>
<p>end - 2 + end - 3 + end - 4 + … + end-0,z明显计算量不小！</p>
<h4 id="反向传播计算梯度">反向传播计算梯度<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#反向传播计算梯度" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>从最后一层开始计算，先计算出最后一层梯度，可以直接计算出来，这样每次往前计算不用再一直累加，因此计算量小很多。所以说BP算法刚好就是利用了原来的网络和参数而且可以用和前向传播相同的计算量计算出所有w的梯度。这就是BP算法的精妙之处！</p>
<h2 id="代码实现">代码实现<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#代码实现" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>在这里手动搭建了一个神经网络，暂时没有考虑b，因为只是用来加深理解，又一个输入层，两个隐藏层，一个输出层，每层四个神经元。所有参数都是手动计算梯度。</p>
<p>根据以上分析的反向传播算法可以总结出以下几步：</p>
<ul>
<li>前向传播一遍计算出所有节点的值</li>
<li>反向传播一遍计算出所有结点的偏微分</li>
<li>做乘法求出所有的梯度进行更新</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light nord"><code data-language="python" data-theme="github-light nord" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> numpy </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">#Generate data</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;"># Forward Node</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">x_F </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">y_F </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">z_F </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">p_F </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">#weight</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">x_y_w </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">y_z_w </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">z_p_w </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">#backward node</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">x_B </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">y_B </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">z_B </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">p_B </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">#TARGET</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">target </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.7</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">])</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">#loss</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> SquareErrorLoss</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9;">output</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">):</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#88C0D0;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#88C0D0;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">output</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)):</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">        loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">output</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">i</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">i</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">])</span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">2</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> loss</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> loss</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;"># Graident</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">lr </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.0000001</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> epoch </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#88C0D0;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">500000</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">):</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">    # forward0</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    y_F </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">matmul</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">x_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> x_y_w</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    z_F </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">matmul</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">y_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> y_z_w</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    p_F </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">matmul</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">z_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> z_p_w</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">  # 得到输出</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    loss_end </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;"> SquareErrorLoss</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">p_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">    # backward</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    p_B </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">p_F  </span><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;"># end grad</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    z_B </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">matmul</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">p_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> z_p_w</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    y_B </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">matmul</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">z_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> y_z_w</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">    # print(z_F[0])</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">    # grad</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    z_p_w_grad </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;"> [</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">z_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> p_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">                  np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">z_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> p_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">                  np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">z_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> p_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">                  np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">z_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> p_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)]</span><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">  # 4*4</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    y_z_w_grad </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;"> [</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">y_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> z_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">                  np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">y_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> z_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">                  np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">y_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> z_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">                  np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">y_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> z_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)]</span><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">  # 4*4</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    x_y_w_grad </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;"> [</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">x_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> y_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">                  np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">x_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> y_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">                  np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">x_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> y_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">                  np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">x_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">],</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> y_B</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)]</span><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">  # 4*4</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">    # update</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    x_y_w </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> x_y_w </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> lr </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">x_y_w_grad</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    y_z_w </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> y_z_w </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> lr </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">y_z_w_grad</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">    z_p_w </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> z_p_w </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> lr </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> np</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#88C0D0;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">z_p_w_grad</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;"> epoch </span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;">%</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 5000</span><span style="--shiki-light:#D73A49;--shiki-dark:#81A1C1;"> ==</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">:</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#88C0D0;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#A3BE8C;">当前loss值为</span><span style="--shiki-light:#032F62;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#88C0D0;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">loss_end</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#88C0D0;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">p_F</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#616E88;">#截取输出片段打印</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">165.06777280622663</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">8.38287281</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 5.70538503</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 7.00228248</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 5.84052431</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">133.11940656598998</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">7.56299701</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 5.15781875</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 6.33931068</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 5.28536964</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">109.77775387801975</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">6.89894847</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 4.7147705</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">  5.8028157</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">  4.83622736</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">92.14372363473903</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">6.34836332</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 4.34779557</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 5.35839007</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 4.4642465</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;"> ]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">78.45934876430728</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">5.88318774</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 4.03806177</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 4.98325151</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 4.1503256</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;"> ]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">67.60388807433274</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">5.48405883</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 3.77257388</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 4.66167746</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 3.88128352</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">58.833090378271265</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">5.13715314</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 3.54205652</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 4.38244476</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 3.64771203</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">51.6356735906825</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">4.83232077</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 3.3397007</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">  4.13731374</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 3.44270456</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;">...</span><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;"> ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;"> ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;"> ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;"> ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;"> ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;"> ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;"> ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;"> ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;"> ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;"> ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#D8DEE9FF;"> ...</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.34148441938663887</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.38019982</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.42063884</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.60690939</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.49356868</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.33762403308295663</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.37029135</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.41401346</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.59891746</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.48685882</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.3343170568629769</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.36058041</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.40751086</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.5910724</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">  0.48027121</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.3315343883568477</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.3510625</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">  0.40112821</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.58337076</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.47380298</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#D8DEE9FF;">当前loss值为</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.3292483287899748</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">0.3417333</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;">  0.39486274</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.57580922</span><span style="--shiki-light:#005CC5;--shiki-dark:#B48EAD;"> 0.46745137</span><span style="--shiki-light:#24292E;--shiki-dark:#ECEFF4;">]</span></span></code></pre></figure>
<p>以上代码可以看出，loss值不断不断的下降，并且最终趋于稳定，可以说明由之前的推导总结出的方法思路并无问题！</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-49" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><ul id="list-1" class="toc-content overflow"><li class="depth-0"><a href="#前置知识" data-for="前置知识">前置知识</a></li><li class="depth-0"><a href="#案例背景" data-for="案例背景">案例背景</a></li><li class="depth-0"><a href="#层层深入" data-for="层层深入">层层深入</a></li><li class="depth-1"><a href="#forward-pass" data-for="forward-pass">Forward Pass</a></li><li class="depth-1"><a href="#backward-pass" data-for="backward-pass">Backward Pass</a></li><li class="depth-1"><a href="#反求" data-for="反求">反求</a></li><li class="depth-1"><a href="#大胆假设细心求证" data-for="大胆假设细心求证">大胆假设、细心求证</a></li><li class="depth-0"><a href="#conclusion--question" data-for="conclusion--question">Conclusion &amp; Question</a></li><li class="depth-1"><a href="#bp算法总结" data-for="bp算法总结">BP算法总结</a></li><li class="depth-1"><a href="#思考" data-for="思考">思考</a></li><li class="depth-0"><a href="#代码实现" data-for="代码实现">代码实现</a></li><li class="overflow-end"></li></ul></div><div class="backlinks"><h3>Backlinks</h3><ul id="list-2" class="overflow"><li><a href="../A_Navigation/Research-Knowledge" class="internal">Research Knowledge</a></li><li><a href="../C_Research_Knowledge/" class="internal">index</a></li><li><a href="../C_Research_Knowledge/梯度下降法3" class="internal">梯度下降法 ③_数学公式起源深入</a></li><li><a href="../C_Research_Knowledge/深度学习入门系列-逻辑回归" class="internal">Logistic Regression</a></li><li><a href="../C_Research_Knowledge/深度学习入门系列4-反向传播BP算法" class="internal">反向传播BP算法</a></li><li><a href="../C_Research_Knowledge/深度学习入门系列6-Convolution-Neural-Network-CNN-卷积神经网络" class="internal">Convolution Neural Network(CNN)卷积神经网络</a></li><li><a href="../C_Research_Knowledge/深度学习入门系列7-Tips-For-DeepLearning-全程高能" class="internal">Tips For DeepLearning_1</a></li><li><a href="../C_Research_Knowledge/深度学习入门系列8-Tips-For-DeepLearning-2-全程高能" class="internal">Tips For DeepLearning_2</a></li><li><a href="../C_Research_Knowledge/深度学习入门系列一-梯度下降法-②" class="internal">梯度下降法 ②_学习率</a></li><li><a href="../C_Research_Knowledge/深度学习入门系列一-梯度下降法" class="internal">梯度下降法 ①_概述</a></li><li class="overflow-end"></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.2</a> © 2026</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript" data-persist="true">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module" data-persist="true">function E(a,e){if(!a)return;function t(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function n(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}a?.addEventListener("click",t),window.addCleanup(()=>a?.removeEventListener("click",t)),document.addEventListener("keydown",n),window.addCleanup(()=>document.removeEventListener("keydown",n))}function f(a){for(;a.firstChild;)a.removeChild(a.firstChild)}var m=class{constructor(e,t){this.container=e;this.content=t;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),t=this.onMouseMove.bind(this),n=this.onMouseUp.bind(this),o=this.onTouchStart.bind(this),r=this.onTouchMove.bind(this),i=this.onTouchEnd.bind(this),s=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",t),document.addEventListener("mouseup",n),this.container.addEventListener("touchstart",o,{passive:!1}),document.addEventListener("touchmove",r,{passive:!1}),document.addEventListener("touchend",i),window.addEventListener("resize",s),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",t),()=>document.removeEventListener("mouseup",n),()=>this.container.removeEventListener("touchstart",o),()=>document.removeEventListener("touchmove",r),()=>document.removeEventListener("touchend",i),()=>window.removeEventListener("resize",s))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let t=this.createButton("+",()=>this.zoom(.1)),n=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(n),e.appendChild(o),e.appendChild(t),this.container.appendChild(e)}createButton(e,t){let n=document.createElement("button");return n.textContent=e,n.className="mermaid-control-button",n.addEventListener("click",t),window.addCleanup(()=>n.removeEventListener("click",t)),n}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}onTouchStart(e){if(e.touches.length!==1)return;this.isDragging=!0;let t=e.touches[0];this.startPan={x:t.clientX-this.currentPan.x,y:t.clientY-this.currentPan.y}}onTouchMove(e){if(!this.isDragging||e.touches.length!==1)return;e.preventDefault();let t=e.touches[0];this.currentPan={x:t.clientX-this.startPan.x,y:t.clientY-this.startPan.y},this.updateTransform()}onTouchEnd(){this.isDragging=!1}zoom(e){let t=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),n=this.content.getBoundingClientRect(),o=n.width/2,r=n.height/2,i=t-this.scale;this.currentPan.x-=o*i,this.currentPan.y-=r*i,this.scale=t,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){let t=this.content.querySelector("svg").getBoundingClientRect(),n=t.width/this.scale,o=t.height/this.scale;this.scale=1,this.currentPan={x:(this.container.clientWidth-n)/2,y:(this.container.clientHeight-o)/2},this.updateTransform()}},T=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],y;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;y||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let t=y.default,n=new WeakMap;for(let r of e)n.set(r,r.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let c=n.get(s);c&&(s.innerHTML=c)}let r=T.reduce((s,c)=>(s[c]=window.getComputedStyle(document.documentElement).getPropertyValue(c),s),{}),i=document.documentElement.getAttribute("saved-theme")==="dark";t.initialize({startOnLoad:!1,securityLevel:"loose",theme:i?"dark":"base",themeVariables:{fontFamily:r["--codeFont"],primaryColor:r["--light"],primaryTextColor:r["--darkgray"],primaryBorderColor:r["--tertiary"],lineColor:r["--darkgray"],secondaryColor:r["--secondary"],tertiaryColor:r["--tertiary"],clusterBkg:r["--light"],edgeLabelBackground:r["--highlight"]}}),await t.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let r=0;r<e.length;r++){let v=function(){let g=l.querySelector("#mermaid-space"),h=l.querySelector(".mermaid-content");if(!h)return;f(h);let w=i.querySelector("svg").cloneNode(!0);h.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new m(g,h)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},i=e[r],s=i.parentElement,c=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(c),L=c.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),E(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript" data-persist="true"></script><script src="../postscript.js" type="module" data-persist="true"></script></html>